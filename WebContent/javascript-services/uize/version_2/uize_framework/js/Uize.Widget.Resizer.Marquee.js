/*
	UIZE JAVASCRIPT FRAMEWORK 2010-01-24

	http://www.uize.com/reference/Uize.Widget.Resizer.Marquee.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget.Resizer.Marquee',required:'Uize.Node',builder:function(d_a){var d_b=true,d_c=false,d_d=Uize.Node;var d_e=d_a.subclass(function(){var d_f=this;function d_g(){d_f.d_h();d_f.d_i();}d_f.wire({'Changed.inDrag':d_g,'Changed.creatingNew':d_g,'Changed.fixedX':d_g,'Changed.fixedY':d_g,'Changed.activeHandleEffectivePointIdX':d_g,'Changed.activeHandleEffectivePointIdY':d_g});}),d_j=d_e.prototype;d_j.d_h=function(){var d_f=this;if(d_f.isWired){var d_k=d_f.get('inDrag'),d_l=d_f.get('creatingNew'),d_m=d_f.get('fixedX'),d_n=d_f.get('fixedY'),d_o=d_f.get('activeHandleEffectivePointIdX'),d_p=d_f.get('activeHandleEffectivePointIdY'),d_q=d_e.pointIdsMap;for(var d_r in d_q){if(d_r!='move'){var d_s=d_q[d_r];d_f.displayNode(d_r,(!d_l&&(!d_m||d_s[0]==.5)&&(!d_n||d_s[1]==.5)&&(!d_f.d_t|| !d_k||(d_s[0]==d_o&&d_s[1]==d_p))));}}}};d_j.d_i=function(){var d_f=this;if(d_f.isWired){var d_u=d_f.get('left'),d_v=d_f.get('top'),d_w=d_f.get('width')-1,d_x=d_f.get('height')-1,d_q=d_e.pointIdsMap;
for(var d_r in d_q){if(d_r!='move'){var d_s=d_q[d_r],d_y=d_f.getNode(d_r),d_z=d_d.getDimensions(d_y);d_d.setStyle(d_y,{left:d_u+d_s[0]*d_w-(d_z.width-1)/2,top:d_v+d_s[1]*d_x-(d_z.height-1)/2});}}}};d_j.updateUi=function(){var d_f=this;if(d_f.isWired){d_a.prototype.updateUi.call(d_f);d_f.d_i();}};d_j.wireUi=function(){var d_f=this;if(!d_f.isWired){if(d_f.d_A){var d_B=d_f.getNode('shell');d_d.setStyle(d_B,{cursor:'crosshair'});d_f.wireNode(d_B,'mousedown',function(d_C){if(!d_C)d_C=event;var d_D=d_d.getCoords(d_B),d_r=d_f.get('aspectRatio')==null?'northWest':'southEast',d_E=document.documentElement;d_f.set({creatingNew:d_b});d_f.setPositionDuringDrag(d_C.clientX+d_E.scrollLeft-d_D.left,d_C.clientY+d_E.scrollTop-d_D.top,d_f.get('minWidth'),d_f.get('minHeight'));return d_f.children[d_r].mousedown(d_C);});}d_a.prototype.wireUi.call(d_f);d_f.d_h();}};d_e.registerProperties({d_t:{name:'hideOtherHandlesInDrag',value:d_c},d_A:{name:'shellLive',value:d_b}});d_e.set({areaNodes:['move','border'],html:{
process:function(input){function d_F(d_r){return('<img id="'+input.idPrefix+'-'+d_r+'" src="'+input.blankGif+'"'+(input.handleCssClass?(' class="'+input.handleCssClass+'"'):'')+' style="position:absolute; z-index:1000; display:none;'+(input.handleCssClass?'':(' width:7px; height:7px; background:#ccc; border:1px solid #fff;'))+'"/>');}return('<div id="'+input.idPrefix+'-border" style="position:absolute; left:0px; top:0px; width:200px; height:200px; border:1px solid #000; background:url('+input.blankGif+'); z-index:999;"></div>'+'<a id="'+input.idPrefix+'-move" href="javascript://" style="display:block; position:absolute; left:0px; top:0px; width:200px; height:200px; border:1px dashed #fff; z-index:1000; background:url('+input.blankGif+');"></a>'+d_F('northWest')+d_F('north')+d_F('northEast')+d_F('west')+d_F('east')+d_F('southWest')+d_F('south')+d_F('southEast'));}},nodeMap:{shell:''}});return d_e;}});