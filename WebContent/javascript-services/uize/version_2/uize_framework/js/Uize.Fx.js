/*
	UIZE JAVASCRIPT FRAMEWORK 2010-01-24

	http://www.uize.com/reference/Uize.Fx.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Fx',required:['Uize.Fade.xFactory','Uize.Node','Uize.Color'],builder:function(){var _a=function(){},_b;var _c=[],_d,_e={},_f=Uize.Node.isIe;function _g(_h){if((_d||(_d={}))[_h])return _d[_h];for(var _i=_c.length,_j;--_i> -1;){if(typeof(_j=_c[_i].test)=='string'?_h==_j:typeof _j=='function'?_j(_h):_j.test(_h))return _d[_h]=_c[_i];}}var _k=_a.defineStylePropertiesProfile=function(_l){_c.push(_l);if(_d)_d=_b;};_a.fadeStyle=function(_m,_n,_o,_p,_q,_r){if(!(_m=Uize.Node.getById(_m)))return;var _h,_s={};for(_h in _n)_s[_h]=1;for(_h in _o)_s[_h]=1;var _t=[],_u={},_v={},_w={},_x;function _y(_z){var _A=_z&&_z[_h];return(_x(_A!=_b?_A:Uize.Node.getStyle(_m,_h)));}for(_h in _s){_t.push(_h);var _l=_g(_h);_x=_l.decoder;_u[_h]=_y(_n);_v[_h]=_y(_o);_w[_h]=_l.quantization;}var _B=_t.sort().join(),_C=_e[_B];if(!_e[_B]){var _D=['var nodeStyle = this.style;','if (!nodeStyle) return;'];for(_h in _s){var _l=_g(_h);_D.push('nodeStyle.'+(_l.remappedProperty||_h)+'='+_l.encoderExpression.replace('VALUE',
'style.'+_h)+';');}_C=_e[_B]=new Function('style',_D.join(''));}return Uize.Fade.fade({context:_m,handler:_C},_u,_v,_p,Uize.copyInto({quantization:_w},_q),_r);};_a.fadeStyleAcrossNodes=function(_E,_n,_o,_q){var _F={},_G={style:_F},_H=_a.fadeStyle(_G,_n,_o,0,_q,false),_I=_H.get('reverse');_H.set({progress:1});for(var _J= -1,_K=(_E=Uize.Node.find(_E)).length-1;++_J<=_K;){_K&&_H.set({progress:(_I?_K-_J:_J)/_K});Uize.copyInto(_E[_J].style,_F);}};_k({test:Uize.Node.returnTrue,decoder:function(_L){return _L},encoderExpression:'VALUE'});_k({test:/(fontSize|left|top|right|bottom|width|height|padding|margin|spacing|textIndent)/i,decoder:function(_L){return typeof _L=='number'?_L:parseInt(_L)||0},encoderExpression:'VALUE+"px"',quantization:1});_k({test:/color|^background$/i,decoder:function(_L){return Uize.Color.to(_L,'RGB array')},encoderExpression:'"Rgb("+VALUE.join(",")+")"',quantization:1});var _M={left:'0%',right:'100%',top:'0%',bottom:'100%',center:'50%'};_k({test:'backgroundPosition',decoder:function(_L){if(_L){
if(Uize.isArray(_L)&&_L.length==2)_L=_L[0]+' '+_L[1];if(typeof _L=='string'){_L=_L.replace(/left|right|top|bottom|center/gi,function(_N){return _M[_N]}).match(/(left|center|right|[\+\-]?\d+)(%|px)?\s+(top|center|bottom|[\+\-]?\d+)(%|px)?/);_L&&_L.shift();}}if(!_L)_L=[0,'px',0,'px'];return[parseInt(_L[0])||0,(_L[1]||'px')+' ',parseInt(_L[2])||0,(_L[3]||'px')+' '];},encoderExpression:'VALUE.join("")',quantization:1});var _O='(\\d+)\\s*(?:px)?\\s*,?\\s*',_P=new RegExp(_O+_O+_O+_O,'i');_k({test:'clip',decoder:function(_L){Uize.isArray(_L)||((_L=_L.match(_P))?_L.shift():(_L=[0,0,0,0]));return[parseInt(_L[0]),parseInt(_L[1]),parseInt(_L[2]),parseInt(_L[3])];},encoderExpression:'"rect("+VALUE.join("px,")+"px)"',quantization:1});_k({test:'opacity',remappedProperty:_f?'filter':'opacity',decoder:function(_L){return+_L},encoderExpression:_f?'"alpha(opacity="+Math.round(VALUE*100)+")"':'VALUE'});return _a;}});