/*
	UIZE JAVASCRIPT FRAMEWORK 2010-01-24

	http://www.uize.com/reference/Uize.Widget.TableSort.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget.TableSort',required:'Uize.Node',builder:function(c_a){var c_b,c_c=null,c_d=true,c_e=false,c_f=Uize.Node;function c_g(c_h,c_i){var c_j=[],c_k=c_h.childNodes,c_l=c_k.length;for(var c_m= -1;++c_m<c_l;){var c_n=c_k[c_m];c_n.tagName==c_i&&c_j.push(c_n);}return c_j;}function c_o(c_h){return c_f.getById(c_h).getElementsByTagName('tbody')[0];}function c_p(c_q){var c_r=c_g(c_q,'TD');if(!c_r.length)c_r=c_g(c_q,'TH');return c_r;}var c_s=c_a.subclass(function(c_t){var c_u=this;c_u.c_v=[];c_u.c_w=[];c_u.c_x=c_u.c_y=c_u.c_z=c_c;c_u.c_A=c_d;}),c_B=c_s.prototype;c_B.c_C=function(c_D){var c_u=this;return(c_D==c_u.c_y? !c_u.c_A:((c_u.c_E&&c_u.c_E[c_D])||c_u.c_F)=='ascending');};c_B.c_G=function(c_D){var c_u=this;if(c_u.isWired){var c_H=c_u.c_v[c_D];c_H.className=(c_D==c_u.c_y?c_u.c_I:(c_D==c_u.c_x?c_u.c_J:c_u.c_w[c_D]))||'';c_H.title=c_u.c_C(c_D)?c_u.c_K:c_u.c_L;}};c_B.c_M=function(c_q){var c_u=this;if(c_u.isWired&&c_q)c_q.className=(c_q==c_u.c_z?c_u.c_N:c_q.Uize_TableSort_a)||'';};
c_B.c_O=function(c_D){var c_u=this;c_u.c_P();c_u.c_x=c_D;c_u.c_G(c_D);};c_B.c_P=function(){var c_u=this;if(c_u.c_x!=c_c){var c_Q=c_u.c_x;c_u.c_x=c_c;c_u.c_G(c_Q);}};c_B.c_R=function(c_q){var c_u=this;c_u.c_S();c_u.c_z=c_q;c_u.c_M(c_q);};c_B.c_S=function(){var c_u=this;if(c_u.c_z){var c_T=c_u.c_z;c_u.c_z=c_c;c_u.c_M(c_T);}};c_B.sort=function(c_D){var c_u=this,c_U=c_o(c_u.getNode()),c_V=c_g(c_U,'TR'),c_W=c_V.length,c_X=[],c_Y=[],c_Z=c_d,c_0=c_d;c_u.c_A=c_u.c_C(c_D);for(var c_1= -1;++c_1<c_W;){c_Y[c_1]=c_1;if(c_1!=c_u.c_2){var c_r=c_p(c_V[c_1]);if(c_r.length==c_u.c_v.length){var c_3=c_f.getText(c_r[c_D]);if(c_3){c_0=c_0&& !isNaN(+new Date(c_3));c_Z=c_Z&&/\d/.test(c_3);c_X[c_1]=c_3;}}}}function c_4(c_5,c_6){return c_5==c_6?0:(c_5<c_6? -1:1);}var c_7=c_4,c_8=c_0||c_Z,c_9=c_8?c_7:c_4,c_ba=c_u.c_A?1: -1;function c_bb(c_bc){return c_X[c_Y[c_bc]]===c_b;}if(c_8){for(var c_1= -1;++c_1<c_W;){if(!c_bb(c_1))c_X[c_1]=c_0? +new Date(c_X[c_1]): +c_X[c_1].replace(/[^\d\.]/g,'');}}var c_bd=c_W-1;for(var c_be= -1;++c_be<c_bd;){
if(!c_bb(c_be)){for(var c_bf=c_be;++c_bf<c_W;){if(!c_bb(c_bf)){if(c_ba==c_9(c_X[c_Y[c_be]],c_X[c_Y[c_bf]])){var c_bg=c_Y[c_be];c_Y[c_be]=c_Y[c_bf];c_Y[c_bf]=c_bg;}}}}}for(var c_1= -1;++c_1<c_W;)c_U.appendChild(c_V[c_Y[c_1]]);if(c_D!=c_u.c_y){if(c_u.c_y!=c_c){var c_bh=c_u.c_y;c_u.c_y=c_c;c_u.c_G(c_bh);}c_u.c_y=c_D;c_u.c_G(c_D);}};c_B.updateUi=function(){var c_u=this;for(var c_D= -1;++c_D<c_u.c_v.length;)c_u.c_G(c_D);c_u.c_M(c_u.c_z);};c_B.wireUi=function(){var c_u=this;if(!c_u.isWired){var c_bi=c_u.getNode(),c_U=c_o(c_u.getNode()),c_bj=c_g(c_U,'TR');var c_bk=0,c_bl=c_bj.length;for(var c_1= -1;++c_1<c_bl;)c_bk=Math.max(c_bk,c_p(c_bj[c_1]).length);function c_bm(c_V){for(var c_1= -1,c_W=c_V.length;++c_1<c_W;){var c_bn=c_p(c_V[c_1]);if(c_bn.length==c_bk){c_u.c_v=c_bn;c_u.c_2=c_1;break;}}}var c_bo=c_bi.getElementsByTagName('thead');if(c_bo.length>0){var c_bp=c_g(c_bo[0],'TR');if(!c_bp.length)c_bp=[c_bo[0]];c_bm(c_bp);}c_u.c_2= -1;c_u.c_v.length||c_bm(c_bj);function c_bq(c_D){var c_H=c_u.c_v[c_D];
c_u.c_w[c_D]=c_H.className;c_u.wireNode(c_H,{mouseover:function(){c_u.c_O(c_D)},mouseout:function(){c_u.c_P()},click:function(){c_u.sort(c_D)}});}for(var c_br= -1,c_bs=c_u.c_v.length;++c_br<c_bs;)c_bq(c_br);var c_bt=[],c_bs=c_u.c_v.length;for(var c_D= -1;++c_D<c_bs;)c_bt[c_D]=c_f.getText(c_u.c_v[c_D]);function c_bu(c_q){c_q.Uize_TableSort_a=c_q.className;c_u.wireNode(c_q,{mouseover:function(){c_u.c_R(c_q)},mouseout:function(){c_u.c_S()}});}for(var c_1= -1,c_bl=c_bj.length;++c_1<c_bl;){if(c_1!=c_u.c_2){var c_q=c_bj[c_1],c_r=c_p(c_q);c_r.length==c_u.c_v.length&&c_bu(c_q);for(var c_br= -1;++c_br<c_r.length;){if(c_u.c_bv&&c_br in c_u.c_bv?c_u.c_bv[c_br]:c_u.c_bw)c_r[c_br].title=c_bt[c_br];}}}c_a.prototype.wireUi.call(c_u);}};var c_bx='updateUi';c_s.registerProperties({c_bw:{name:'cellTooltips',value:c_d},c_bv:'cellTooltipsByColumn',c_F:{name:'dominantSortOrder',value:'ascending'},c_E:'dominantSortOrderByColumn',c_J:{name:'headingOverClass',onChange:c_bx},c_I:{name:'headingLitClass',onChange:c_bx},c_K:{
name:'languageSortAscending',onChange:c_bx,value:'Click to sort in ascending order'},c_L:{name:'languageSortDescending',onChange:c_bx,value:'Click to sort in descending order'},c_N:{name:'rowOverClass',onChange:c_bx}});return c_s;}});