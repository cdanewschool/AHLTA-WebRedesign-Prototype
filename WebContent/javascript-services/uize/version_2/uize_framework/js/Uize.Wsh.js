/*
	UIZE JAVASCRIPT FRAMEWORK 2010-01-24

	http://www.uize.com/reference/Uize.Wsh.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Wsh',builder:function(){var _a=function(){},_b;function _c(_d){return((typeof _d=='object'&&_d&&_d.fileSystemObject)||_a._e||(_a._e=new ActiveXObject('Scripting.FileSystemObject')));}_a.fileExists=function(_f){return _c().FileExists(_f);};_a.getFiles=function(_g){var _h=[],_i=new Enumerator(_e.getFolder(_g).files);while(!_i.atEnd()){_h.push(_i.item().Path);_i.moveNext();}return _h;};var _j=_a.getScriptFolderPath=function(){return WScript.ScriptFullName.slice(0,-WScript.ScriptName.length-1);};var _k=_a.readFile=function(_d){var _l=_c(_d).OpenTextFile(typeof _d=='string'?_d:_d.path,1),_m=_l.ReadAll();_l.Close();return _m;};var _n=_a.writeFile=function(_d){var _o=_d.path,_e=_c(_d);var _g=_o.substr(0,_o.lastIndexOf('\\'));if(!_e.FolderExists(_g)){var _p=_g.split('\\'),_q=_p[0];for(var _r=0,_s=_p.length;++_r<_s;){_q+='\\'+_p[_r];_e.FolderExists(_q)||_e.CreateFolder(_q);}}var _l=_e.CreateTextFile(_o);_l.Write(_d.text);_l.Close();};_a.buildFiles=function(_d){var _t=_d.alwaysBuild,
_u=_d.dryRun,_e=_c(_d),_v=WScript.ScriptName,_w=WScript.ScriptFullName,_x=_d.doNotEnter,_y=[];if(Uize.isArray(_x))_x=new RegExp('\\\\('+_x.join('|')+')(\\W|$)');function _z(_f){return+new Date(_e.GetFile(_f).DateLastModified);}function _A(_g){var _B=_e.getFolder(_g),_C=new Enumerator(_B.SubFolders),_D=_x&&_x.test(_g)?false:_d.targetFolderPathCreator(_g);if(typeof _D=='string'){var _i=new Enumerator(_B.files);while(!_i.atEnd()){var _E=_i.item().Path;if(_E!=_w){var _F=_E.substr(_E.lastIndexOf('\\')+1),_G=_d.targetFilenameCreator(_F);if(_G){var _H=_D+'\\'+_G,_I=_t?'ALWAYS BUILD':(_e.FileExists(_H)?(_z(_E)>_z(_H)?'WAS OUT OF DATE':''):'DIDN\'T EXIST'),_J,_K='';if(_I){var _L=new Date,_M=_d.fileBuilder(_F,_k(_E)),_N=_M.outputText;_K=_M.logDetails||'';!_u&&_N!=_b&&_n({path:_H,text:_N});_J=new Date-_L;}_y.push((_I?'***** ':'')+_E+'\n'+'\tTARGET FILE: '+_H+'\n'+'\t'+(_I?('BUILT ('+_I+'), BUILD DURATION: '+_J+'ms'):'no action, file is current')+'\n'+_K+'\n');}}_i.moveNext();}}if(_D!==false){while(!_C.atEnd()){
_A(_C.item().Path);_C.moveNext();}}}_A(_j());_n({path:_d.logFileName||_v.replace(/\.js$/,'.log'),text:_y.join('')});};function _O(_P,_Q,_R){return((_O._S||(_O._S=new ActiveXObject('wscript.shell'))).Popup(_P+'',0,_Q,_R));}alert=function(_P){_O(_P,'Windows Script Host Alert',0|48);};confirm=function(_P){return _O(_P,'Please Confirm...',1|32)==1;};return _a;}});