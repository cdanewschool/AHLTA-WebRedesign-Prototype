/*
	UIZE JAVASCRIPT FRAMEWORK 2010-01-24

	http://www.uize.com/reference/Uize.Widget.PopupPalette.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget.PopupPalette',required:['Uize.Node','Uize.Fade','Uize.Widget.Button'],builder:function(c_a){var c_b=true,c_c=false,c_d=Uize.Node;var c_e=c_a.subclass(null,function(){var c_f=this;c_f.fade=new Uize.Fade({duration:750,acceleration:0,deceleration:1});c_f.fade.wire({'Changed.value':function(){c_f.setNodeOpacity('palette',c_f.fade)},Done:function(){c_f.c_g(c_f.c_h)}});var c_i=c_f.c_i=c_f.c_j('selector',function(c_k){c_f.toggle('shown')});c_i.set({clickToDeselect:c_b});c_f.c_l();function c_m(c_k){var c_n=c_k.name=='Over';c_f.c_o&&c_n&&c_f.set({c_h:c_b});c_n?c_f.c_p():c_f.c_q()}c_i.wire({Down:c_r,Over:c_m,Out:c_m});c_s[c_f.instanceId]=c_f;}),c_t=c_e.prototype,c_s={};c_t.c_l=function(){this.c_i.set({selected:this.c_h})};c_t.c_u=function(){return this.c_h&&(this.c_o||this.c_v);};c_t.c_p=function(){this.c_u()&&this.c_w()};c_t.c_q=function(){this.c_u()&&this.c_x()};c_t.c_j=Uize.Widget.Button.addChildButton;c_t.c_g=function(c_y){var c_f=this;c_f.displayNode('palette',c_y);
c_y&&c_f.setNodeStyle('palette',{filter:''});c_f.fire({name:'Palette '+(c_y?'Shown':'Dismissed'),bubble:c_b});};c_t.c_w=function(){var c_f=this;if(c_f.c_z){clearTimeout(c_f.c_z);c_f.c_z=null;}};c_t.c_x=function(){var c_f=this;c_f.c_w();c_f.c_z=setTimeout(function(){c_f.set({c_h:c_c})},250);};c_t.kill=function(){delete c_s[this.instanceId];c_a.prototype.kill.call(this);};c_t.wireUi=function(){var c_f=this;if(!c_f.isWired){c_f.wireNode('palette',{mousedown:c_r,mouseup:function(c_k){c_f.c_A&&c_k.target!=c_f.getNode('palette')&&c_f.set({c_h:c_c});},mouseover:function(){c_f.c_p()},mouseout:function(){c_f.c_q()}});c_f.wireNode('paletteClose','click',function(){c_f.set({c_h:c_c})});if(c_f.c_B=='absolute'){var c_C=document.body,c_D=c_f.getNode('palette');if(c_D&&c_D.parentNode!=c_C){var c_E=c_d.getDimensions(c_D).width;c_C.insertBefore(c_D,c_C.childNodes[0]);c_f.setNodeStyle(c_D,{zIndex:10000,position:'absolute',left:'',top:'',right:'',bottom:'',width:c_E});}}c_a.prototype.wireUi.call(c_f);}};c_e.registerProperties({
c_F:{name:'exclusive',value:c_b},c_v:{name:'hideWhenOut',value:c_c},c_A:{name:'hideOnClick',value:c_b},c_B:{name:'positioning',value:'none'},c_h:{name:'shown',onChange:function(){var c_f=this,c_h=c_f.c_h;c_f.c_i&&c_f.c_l();if(c_f.isWired){c_f.c_w();if(c_h){c_f.fire('Before Palette Shown');c_f.c_F&&c_G(c_f);if(c_f.c_B=='absolute'){function c_H(c_I){c_f.showNode('palette',!c_I);c_f.displayNode('palette',c_I);}c_H(c_b);c_d.setAbsPosAdjacentTo(c_f.getNode('palette'),c_f.c_i.getNode());c_H(c_c);}}if(c_f.fade.get('duration')>0){c_h&&c_f.displayNode('palette');c_f.fade.start({startValue:c_h?0:1,endValue:c_h?1:0});}else{c_f.c_g(c_h);}}},value:c_c},c_o:{name:'showWhenOver',value:c_c}});function c_G(c_J){for(var c_K in c_s){var c_L=c_s[c_K];c_L!=c_J&&c_L.c_F&&c_L.set({c_h:c_c});}}function c_r(){c_M=c_b}var c_M=c_c,c_N=document.onmousedown;document.onmousedown=function(c_k){if(!c_k)c_k=event;c_M?(c_M=c_c):c_G();typeof c_N=='function'&&c_N(c_k);};return c_e;}});