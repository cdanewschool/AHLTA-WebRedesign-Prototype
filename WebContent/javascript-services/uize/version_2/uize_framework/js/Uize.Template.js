/*
	UIZE JAVASCRIPT FRAMEWORK 2010-01-24

	http://www.uize.com/reference/Uize.Template.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Template',required:['Uize.Url','Uize.Json','Uize.String'],builder:function(){var _a=function(){},_b=true,_c=false,_d='string',_e=Uize.Url,_f=Uize.Json,_g=Uize.String,_h=_g.splitInTwo,_i=_g.trim;var _j={},_k=/^\s*=/,_l=/^\s*@/,_m=/^\s*\./,_n=/^!\s*/,_o=/(\r|\n|\r\n)[ \t]*$/,_p=/^[ \t]*(\r|\n|\r\n)[ \t]*/,_q='->';_a.compile=function(_r,_s){function _t(_d,_u){return(_u+_d.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(new RegExp(_u,'g'),'\\'+_u)+_u);}_s=_s||_j;var _v=[],_w={},_x=_s.openerToken||'<%',_y=_s.closerToken||'%>',_z=_s.gobbleWhitespace!==_c,_A=_r.length,_B='var output = [];',_C='return output.join (\'\');',_D=[_B],_E=[],_F=0,_G,_H=_b,_I,_J,_K,_L,_M;function _N(_J){if(_E.length){_D.push('output.push ('+_E.join(',')+');');_E=[];}_D.push(_J);}function required(_O){Array.prototype.push.apply(_v,Uize.isArray(_O)?_O:[_O]);}function input(_P){Uize.copyInto(_w,_P);}function startBlock(_Q,_R){_N('function '+_Q+' ('+(_R||'')+') {'+_B);}function endBlock(){
_N(_C+'}');}while(_H){_G=_r.indexOf(_x,_F);if(_G<0)_G=_A;_I=_r.slice(_F,_G);_H=_G<_A;if(_H){_G+=2;_F=_r.indexOf(_y,_G);_J=_r.slice(_G,_F);_L=_k.test(_J);_M=_L||_m.test(_J);_K= !_M&&_l.test(_J);_F+=2;}if(_I){if(_z&&_H&& !_M&&_o.test(_I)&&_p.test(_r.substr(_F)))_I=_I.replace(_o,'');_I&&_E.push(_t(_I,'\''));;}if(_H){if(_M){_J=_L?_J.replace(_k,''):('input'+_J);var _S=_h(_J,_q),_T=_i(_S[0]),_U=_S[1];if(_U){_U=_U.split(_q);for(var _V= -1,_W=_U.length;++_V<_W;){var _X=_h(_U[_V],'{'),_Y=_i(_X[0]);if(_Y){var _Z=_i(_X[1]),_0=_n.test(_Y),_1=(_0?'de':'en')+'coder';if(_0)_Y=_Y.replace(_n,'');_T='Uize.Template.'+_1+'s.'+_Y+'.'+_1+'('+_T+(_Z?(',{'+_Z):'')+')';}}}_E.push(_T);}else if(_K){eval(_J.replace(_l,''));}else{_N(_J);}}}_N(_C);var _2=_D.join('\n'),_3=new Function('input',_2);return(_s.result=='full'?{input:_w,required:_v,code:_2,templateFunction:_3}:_3);};function _4(_5,_6,_7){var _8=_5,_9=_a[_7?'encoders':'decoders'],_ba=_7?'encoder':'decoder';function _bb(_6){var _bc=typeof _6==_d;if(_bc&&_6.indexOf('|')> -1){
_bb(_6.split('|'));}else{if(!_bc&&Uize.isArray(_6)){for(var _V= -1,_bd=_6.length;++_V<_bd;)_bb(_6[_7?_V:_bd-1-_V]);}else{var _be=_9[_bc?_6:_6.type][_ba];if(_be)_8=_be(_8,_bc?_j:_6);}}}_bb(_6);return _8;};_a.encode=function(_bf,_6){return _4(_bf,_6,_b)};_a.decode=function(_bg,_6){return _4(_bg,_6)};_a.encoders={json:{encoder:_f.to},miniJson:{encoder:function(_bf){return _f.to(_bf,'mini')}},url:{encoder:_e.resolve},urlParams:{encoder:_e.toParams},urlPiece:{encoder:_e.toPiece}};_a.decoders={json:{decoder:_f.from},miniJson:{decoder:_f.from},urlParams:{decoder:_e.fromParams},urlPiece:{decoder:_e.fromPiece}};return _a;}});